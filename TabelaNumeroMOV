USE HubDados
;

WITH TOTAL AS (
SELECT *FROM CorporeRM.TMOV
WHERE CODTMV IN( '1.1.39', '1.1.31')
AND YEAR(DATACRIACAO) = '2024'
)
, CODVEN AS (SELECT * FROM CorporeRM.TVEN)
,SELECAO_1139 AS (
SELECT IDMOV, DATAEMISSAO, A.DATACRIACAO, A.DATAMOVIMENTO, A.DATAPROCESSAMENTO, A.DATASAIDA, A.CAMPOLIVRE1, A.CHAVEORIGEM, A.CHAVEORIGEM_NUMERICO, A.CODDEPARTAMENTO, A.CODCFO, A.NUMEROMOV, A.STATUS, A.RECMODIFIEDON,
CODVEN1,B.NOME AS NOME1, CODVEN2,C.NOME AS NOME2, CODVEN3,D.NOME AS NOME3, CODVEN4, E.NOME AS NOME4
FROM TOTAL A
LEFT JOIN CODVEN B
ON A.CODVEN1 = B.CODVEN
LEFT JOIN CODVEN C
ON A.CODVEN2 = C.CODVEN
LEFT JOIN CODVEN D
ON A.CODVEN3 = D.CODVEN
LEFT JOIN CODVEN E
ON A.CODVEN4 = E.CODVEN
)
SELECT * FROM SELECAO_1139
WHERE NUMEROMOV LIKE '113172' OR IDMOV LIKE '4945308'
ORDER BY DATAEMISSAO DESC